# PS2手柄自定义功能

##### 案例内容

>​	在前面的遥控模式我们已经学会了用PS2来控制小狗的走动以及姿态调节，但仔细查看一下，还有好几个按键还没用上，本案例的内容就是使用PS2剩余键位来控制PYB上LED灯的亮灭。

##### 案例器材

>* 湃湃狗一只
>
>* PS2遥控器
>

![](/pic/ch5/5.1.2/1.png) 

>* PS2接收器
>

![](/pic/ch5/5.1.2/2.png) 

>* PS2接线板
>

![](/pic/ch5/5.1.2/3.png) 

##### 接线方式

>直接将接收器插在接收板上
>

![](/pic/ch5/5.1.2/4.png) 

##### 代码

>(Pyborad的main.py)
>
> ```python
>import dog
>import pyb
>from pyb import LED
> 
> while True:
>     print("按键键位：",dog.ps2_key())#dog.ps2_key()获取当前遥控器按下的键位
>     if dog.ps2_key() == 5:
>         LED(3).on()#3号LED灯亮
>     else:
>         LED(3).off()#3号LED灯灭
>     	pyb.delay(100)#停顿100ms
>     
> ```
> 

##### 案例原理（细节/知识点）

>###### 1.从接收器与手柄提示灯观察

![](/pic/ch5/5.1.2/5.png) 

>   绿灯一直闪烁表示未连接，常亮为已连接
>

![](/pic/ch5/5.1.2/6.png) 

>   两灯一直闪烁表示未连接，只亮绿灯为绿灯模式，红绿灯都亮为红灯模式
>
>###### 2.红绿模式区别
>
>   绿灯模式时：
>
>   左右摇杆模拟值为无效，推到极限时，对应发送UP、RIGHT、DOWN、LEFT、△、○、╳、□，按键L3、R3无效。
>

![](/pic/ch5/5.1.2/7.png) 

>   红灯模式时：
>
>   左右摇杆发送模拟值，0x00~0xFF（0~255）之间，且摇杆按下的键值L3、R3有效；因为红灯模式遥感发送的是模拟值，不能用简单的返回值。传输全部信息可以调用ps2_PSS()获取。

##### PS2函数表

>| PS2                |                                                              |
>| ------------------ | ------------------------------------------------------------ |
>| dog.ps2_key()      | 针对绿灯模式，返回固定值表示按下按键                         |
>| dog.ps2_PSS()      | 返回一个data[8](16进制数组值在0~255）,可以将其转换为二进制更好观察 |
>| dog.tenTtwo(n)     | 十进制转二进制                                               |
>| dog.PS2_mode(bool) | 开启PS2控制派派狗模式                                        |

##### 实测图

>- 视频演示 [https://www.bilibili.com/video/av83150253?from=search&seid=3682048618114862780](https://www.bilibili.com/video/av83150253?from=search&seid=3682048618114862780)
>
>- 调试界面
>

![](/pic/ch5/5.1.2/8.png) 
